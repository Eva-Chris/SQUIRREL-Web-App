<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" href="{{ url_for('static', filename= 'css/style.css') }}">
    <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="{{url_for('static', filename='js/highchartTable.js')}}"></script>

    <meta charset="UTF-8">
    <meta name="description" content="Watch next page that shows next round of recommendations">
    <meta name="keywords" content="html, watch_next">
    <meta name="author" content="Eva Chrysostomaki">

    <title>SQUIRREL</title>

    <!--favicon taken from flaticon.com -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename= 'images/squirrel.ico') }}">
</head>

<body>
    <div class="content">
        <h1 id="title">SQUIRREL</h1>

        <!-- navigation bar -->
        <div class="nav_bar">
            <ul class="nav_content">
                <li>
                    <a href="{{url_for('index')}}">
                        <i class='bx bxs-home'></i>
                        <span class="nav_page">Home</span>
                    </a>
                </li>
                <li>
                    <a class="active" href="#watch_next">
                        <i class='bx bxs-movie-play'></i>
                        <span class="nav_page">Watch Next</span>
                    </a>
                </li>
                <li>
                    <a href="{{url_for('about')}}">
                        <i class='bx bxs-info-square'></i>
                        <span class="nav_page">About</span>
                    </a>
                </li>
                <li>
                    <a href="{{url_for('contact')}}">
                        <i class='bx bxs-envelope'></i>
                        <span class="nav_page">Contact</span>
                    </a>
                </li>
            </ul>
        </div>

        {% if test %}
        <b>Select a group: </b>

        <!-- tables with groups -->
        <div class="row">
            <div class="column">
                <table>
                    <thead>
                        <th>Group</th>
                        <th>Show Results</th>
                    </thead>
                    <tbody>

                        {% for test in test[:10] %}
                        <tr>
                            <td><img src="{{ url_for('static', filename = 'images/avatar.png') }}"></td>
                            <form method="post" action="/watch_next">
                                <td><input class="button" type="submit" value="{{test.split('\t', 1)[0]}}"
                                        name="{{test.split('\t', 1)[0]}}" />
                                </td>
                            </form>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="column">
                <table>
                    <thead>
                        <th>Group</th>
                        <th>Show Results</th>
                    </thead>
                    <tbody>

                        {% for test in test[10:] %}
                        <tr>
                            <td><img src="{{ url_for('static', filename = 'images/avatar.png') }}"></td>
                            <form method="post" action="/watch_next">
                                <td><input class="button" type="submit" value="{{test.split('\t', 1)[0]}}"
                                        name="{{test.split('\t', 1)[0]}}" />
                                </td>
                            </form>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}

        <!-- table with recommended movies and individual scores for current round -->
        {% for item in items %}
        {% if loop.first %}
        <b>Group: </b> {{item.id}}
        {% endif %}
        {% endfor %}

        <br>
        <br>

        {% if items %}
        <b><u>Current Round </u></b>
        <table>
            <thead>
                <th>Round</th>
                <th>Recommended Movie</th>
                <th>M1 Score</th>
                <th>M2 Score</th>
                <th>M3 Score</th>
                <th>M4 Score</th>
                <th>M5 Score</th>
            </thead>
            <tbody>

                {% for item in items %}
                <tr>
                    <td>{{item.round}}</td>
                    <td><img src="{{ url_for('static', filename = 'posters/'+ item.movie +'.jpg') }}"></td>
                    <td>{{item.m1_score}}</td>
                    <td>{{item.m2_score}}</td>
                    <td>{{item.m3_score}}</td>
                    <td>{{item.m4_score}}</td>
                    <td>{{item.m5_score}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}

        <br>
        <br>

        <!-- table with scores for current round -->
        {% if cur_round is defined %}
        <b>Current Round Scores:</b>
        <table>
            <thead>
                <th>Overall Satisfaction</th>
                <th>MaxMin</th>
                <th>NDCG</th>
                <th>DFH</th>
                <th>FScore</th>
            </thead>
            <tbody>
                <tr>
                    <td>{{'%0.3f'|format(cur_round[0]|float)}}</td>
                    <td>{{'%0.3f'|format(cur_round[1]|float)}}</td>
                    <td>{{'%0.3f'|format(cur_round[2]|float)}}</td>
                    <td>{{'%0.3f'|format(cur_round[3]|float)}}</td>
                    <td>{{'%0.3f'|format(cur_round[4]|float)}}</td>
                </tr>
            </tbody>
        </table>
        {% endif %}

        <br>
        <br>

        {% if message is defined %}
        {{ message }}
        {% endif %}

        <br>
        <br>

        <!-- table with recommended movies and individual scores for previous rounds -->
        {% if previous_scores %}
        <b><u> Previous Rounds</u></b>
        <table>
            <thead>
                <th>Round</th>
                <th>Recommended Movie</th>
                <th>M1 Score</th>
                <th>M2 Score</th>
                <th>M3 Score</th>
                <th>M4 Score</th>
                <th>M5 Score</th>
            </thead>
            <tbody>

                {% for item in previous_scores %}
                <tr>
                    <td>{{item.round}}</td>
                    <td><img src="{{ url_for('static', filename = 'posters/'+ item.movie +'.jpg') }}"></td>
                    <td>{{item.m1_score}}</td>
                    <td>{{item.m2_score}}</td>
                    <td>{{item.m3_score}}</td>
                    <td>{{item.m4_score}}</td>
                    <td>{{item.m5_score}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}


        <!-- tables with scores and charts -->
        {% if ov_sat is defined and ov_sat|length > 0 %}

        <b>All Scores:</b>

        <br>

        <!--
            <input type="button" class ="button" value="Display All Scores" onclick='show_hide_table();'>
            <br>
            id="displaytable" style="display: none;"-->

        <div class="row">
            <div class="column">
                <table class="highchart" data-graph-container="#graphcontainer" data-graph-type="column"
                    data-graph-color-1="#005EAD">
                    <thead>
                        <th>Round</th>
                        <th>Overall Satisfaction</th>
                    </thead>
                    <tbody>
                        {% for item in ov_sat %}
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>{{'%0.3f'|format(item|float)}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div id="graphcontainer"></div>
            </div>

            <div class="column">
                <table class="highchart2" data-graph-container="#graphcontainer2" data-graph-type="column"
                    data-graph-color-1="#005EAD">
                    <thead>
                        <th>Round</th>
                        <th>MaxMin</th>
                    </thead>
                    <tbody>
                        {% for item in max_min %}
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>{{'%0.3f'|format(item|float)}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div id="graphcontainer2"></div>
            </div>

            <div class="column">
                <table class="highchart3" data-graph-container="#graphcontainer3" data-graph-type="column"
                    data-graph-color-1="#005EAD">
                    <thead>
                        <th>Round</th>
                        <th>NDCG</th>
                    </thead>
                    <tbody>
                        {% for item in ndcg %}
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>{{'%0.3f'|format(item|float)}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div id="graphcontainer3"></div>
            </div>

            <div class="column">
                <table class="highchart4" data-graph-container="#graphcontainer4" data-graph-type="column"
                    data-graph-color-1="#005EAD">
                    <thead>
                        <th>Round</th>
                        <th>DFH</th>
                    </thead>
                    <tbody>
                        {% for item in dfh %}
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>{{'%0.3f'|format(item|float)}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div id="graphcontainer4"></div>
            </div>

            <div class="column">
                <table class="highchart5" data-graph-container="#graphcontainer5" data-graph-type="column"
                    data-graph-color-1="#005EAD">
                    <thead>
                        <th>Round</th>
                        <th>FScore</th>
                    </thead>
                    <tbody>
                        {% for item in f_score %}
                        <tr>
                            <td>{{ loop.index0 }}</td>
                            <td>{{'%0.3f'|format(item|float)}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div id="graphcontainer5"></div>
            </div>
        </div>
        {% endif %}

        {% if cur_round is defined or previous_scores is defined %}
        <input type="button" class="button" value="Go back" onclick="history.back()">
        {% endif %}

    </div>



    <!-- create charts from tables using highcharts -->
    <script>
        $('table.highchart').highchartTable();
        $('table.highchart2').highchartTable();
        $('table.highchart3').highchartTable();
        $('table.highchart4').highchartTable();
        $('table.highchart5').highchartTable();

        /*function show_hide_table() {
            if (document.getElementById("displaytable").style.display === "none")
                document.getElementById("displaytable").style.display = "flex";
            else
                document.getElementById("displaytable").style.display = "none";
        }*/
    </script>


</body>

</html>
